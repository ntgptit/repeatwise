# Code Generation Guide for RepeatWise UI

## Overview
This project uses code generation for:
- **Riverpod**: State management providers
- **Freezed**: Immutable data classes
- **json_serializable**: JSON serialization/deserialization

## Dependencies

### Production Dependencies
```yaml
# State Management
flutter_riverpod: ^2.4.9
riverpod_annotation: ^2.3.3

# JSON Serialization
json_annotation: ^4.8.1

# Code Generation
freezed_annotation: ^2.4.1
```

### Development Dependencies
```yaml
# Code Generation
build_runner: ^2.4.7
riverpod_generator: ^2.3.9
json_serializable: ^6.7.1
freezed: ^2.4.6
```

## Configuration

### build.yaml
```yaml
targets:
  $default:
    builders:
      json_serializable:
        options:
          include_if_null: false
          explicit_to_json: true
          field_rename: snake
      riverpod_generator:
        options:
          provider_name_suffix: "Provider"
          keep_private_name: false
          enable_doc_comments: true
      freezed:
        options:
          copy_with: true
          equal: true
          to_string: true
          union_key: "type"
          union_value_case: "snake"
```

## Usage

### 1. Riverpod Providers
```dart
import 'package:riverpod_annotation/riverpod_annotation.dart';

part 'my_provider.g.dart';

@riverpod
Future<List<User>> getUsers(GetUsersRef ref) async {
  // Implementation
}
```

### 2. Freezed Models
```dart
import 'package:freezed_annotation/freezed_annotation.dart';
import 'package:json_annotation/json_annotation.dart';

part 'user.freezed.dart';
part 'user.g.dart';

@freezed
class User with _$User {
  const factory User({
    required String id,
    required String name,
    required String email,
  }) = _User;

  factory User.fromJson(Map<String, dynamic> json) => _$UserFromJson(json);
}
```

### 3. JSON Serialization (without Freezed)
```dart
import 'package:json_annotation/json_annotation.dart';

part 'user.g.dart';

@JsonSerializable()
class User {
  final String id;
  final String name;
  final String email;

  const User({
    required this.id,
    required this.name,
    required this.email,
  });

  factory User.fromJson(Map<String, dynamic> json) => _$UserFromJson(json);
  Map<String, dynamic> toJson() => _$UserToJson(this);
}
```

## Running Code Generation

### Option 1: Using Flutter CLI
```bash
# Generate all code
flutter pub run build_runner build

# Generate with cleanup
flutter pub run build_runner build --delete-conflicting-outputs

# Watch for changes
flutter pub run build_runner watch
```

### Option 2: Using PowerShell Script
```powershell
# Run the build script
.\scripts\build_runner.ps1
```

### Option 3: Using Dart CLI
```bash
# Generate all code
dart run build_runner build

# Generate with cleanup
dart run build_runner build --delete-conflicting-outputs
```

## Generated Files

After running build_runner, you'll see these generated files:
- `*.g.dart` - Generated by json_serializable and riverpod_generator
- `*.freezed.dart` - Generated by freezed

## Best Practices

1. **Always run build_runner after adding new annotations**
2. **Use `--delete-conflicting-outputs` flag to avoid conflicts**
3. **Keep generated files in version control**
4. **Use extensions for computed properties with Freezed**
5. **Follow naming conventions: `@riverpod` for providers, `@freezed` for models**

## Migration from Manual Implementation

### Before (Manual)
```dart
class User {
  final String id;
  final String name;
  
  const User({required this.id, required this.name});
  
  User copyWith({String? id, String? name}) {
    return User(
      id: id ?? this.id,
      name: name ?? this.name,
    );
  }
  
  @override
  bool operator ==(Object other) {
    return other is User && other.id == id;
  }
  
  @override
  int get hashCode => id.hashCode;
}
```

### After (Freezed)
```dart
@freezed
class User with _$User {
  const factory User({
    required String id,
    required String name,
  }) = _User;
}
```

## Troubleshooting

### Common Issues

1. **"No such file or directory"**
   - Run `flutter pub get` first
   - Ensure all dependencies are properly installed

2. **"Conflicting outputs"**
   - Use `--delete-conflicting-outputs` flag
   - Delete generated files manually and regenerate

3. **"Build failed"**
   - Check for syntax errors in your Dart files
   - Ensure all imports are correct
   - Verify annotation usage

### Clean Build
```bash
# Clean and rebuild
flutter clean
flutter pub get
flutter pub run build_runner build --delete-conflicting-outputs
```
